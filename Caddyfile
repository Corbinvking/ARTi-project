api.artistinfluence.com {
    # Custom API routes for specific paths
    @custom_api path /api/spotify-web-api/* /api/scraper/*
    handle @custom_api {
        reverse_proxy arti-api:3001
    }
    
    # All other /api/* routes go to our API
    handle /api/* {
        reverse_proxy arti-api:3001
    }
    
    # Everything else goes to Supabase Kong
    handle {
        reverse_proxy supabase_kong_arti-marketing-ops:8000
    }
}

custom-api.artistinfluence.com {
    reverse_proxy arti-api:3001
    
    header {
        Access-Control-Allow-Origin *
        Access-Control-Allow-Methods GET, POST, PUT, DELETE, OPTIONS
        Access-Control-Allow-Headers *
    }
    
    @options method OPTIONS
    respond @options 204
}

n8n.artistinfluence.com {
    reverse_proxy arti-n8n:5678
    
    header {
        Strict-Transport-Security max-age=31536000
        X-Content-Type-Options nosniff
        X-Frame-Options SAMEORIGIN
    }
}
